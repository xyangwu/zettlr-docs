# 安全注意事项

Markdown格式通常是一种非常安全的写作方式。与只能以受限模式安全打开的Word文档不同，查看Markdown文档可以不用那么小心。

然而，Markdown文档也可能会受到某些安全问题的困扰。有些文档可能包含恶意代码，对你的安全构成风险。此外，从互联网下载的模板或其他资源可能包含恶意代码，甚至可能在你的计算机上下载病毒和恶意软件。

在使用Zettlr时也需要保持警惕，我们在本页概述了几种会让你面临潜在安全问题的可能。如果你遵循本文档中的常见安全建议并保持警惕，你应该能始终保持安全。

总的来说：Zettlr为你在处理Markdown文件时提供了很大的自由度。因此，Zettlr在导入、查看和导出Markdown文档时能够执行任意代码不属于安全漏洞，而是一个经过深思熟虑的设计决定。正如一句老话所言：“巨大的权力意味着巨大的责任”。

!!! 注意

    Zettlr一直不断接受安全研究者的审查，他们审查该应用程序以查找恶意行为者在你不知情的前提下可以执行代码的方式。

## 在阅读和编写Markdown文档时执行代码

Markdown是一种完全安全的格式，因为它只由源代码组成。换句话说，Markdown文本可以按原样被阅读，只需注意文档中包含的各种格式字符。

然而，有时候查看原始的Markdown文本不那么方便。例如，当你校对文本时，希望看到的是链接的描述，而不是实际链接。同样，当你创建表格时，通常不希望看到许多格式字符，只希望看到实际的表格内容。

让阅读和编写Markdown更容易是Zettlr的目标。为此，Zettlr需要对文档中的一些元素进行预渲染。例如，预渲染链接会隐藏链接而仅显示它们的描述。然而，链接描述可能包含恶意的HTML代码。在表格编辑器中渲染表格时也会出现类似的问题：表格中的每个单元格都可能包含恶意HTML代码在渲染时执行。

因此，为Markdown增强可读性的许多渲染器可能会在文档中执行恶意代码，从而对你的安全构成威胁。

如果你只打开来自信任来源的文件，这应该不会成为问题。但是如果你经常不得不从互联网或你无法完全信任的来源打开Markdown文档，那么禁用这些渲染器可能是有帮助的，以确保不会有包含恶意代码的Markdown文档造成危害。

禁用这些渲染器会使你的Markdown代码变得更难阅读，但将阻止任何恶意代码危害你。

有些渲染器可以执行任意HTML，因此要引起安全注意。这些渲染器包括**表格编辑器**、**iframes**、**链接**和**强调**。

通过在设置中禁用这些渲染器，Zettlr将不会尝试执行此类元素中包含的任何代码。

!!! 注意

    经验法则：即使其他渲染器，如图像渲染器，不能执行代码，但图像也可以为恶意行为者提供另一种渗透计算机的途径。为了安全起见，请禁用所有渲染器。

## 从互联网下载的Markdown文档

一种臭名昭著的攻击向量是分发包含恶意代码的Markdown文档。因此，最好是永远不要从互联网下载Markdown文档。

如果你不得不下载Markdown文档但怀疑其安全性，我们建议首先用常规的文本编辑器（例如Windows上的 Notepad、macOS上的TextEdit或各种可用的基于Linux的文本编辑器）打开它，删除文件中的任何原始HTML，然后再在Zettlr中打开它。

如果你已经禁用了所有渲染器，也可以直接在Zettlr中打开此类文档。

这样即使有一种我们目前尚不知道的损害计算机的方式（称为“零日漏洞”），它也不会造成危害，因为你在使用之前已经删除了潜在的有害代码。

!!! 注意

    经验法则：如果一个Markdown文档内几乎全是HTML代码，这需要引起你的怀疑。Markdown语法对于恶意行为者来说没有多大用处，因此他们会尝试用HTML注入代码。

## 从互联网下载的模板

另一个攻击向量是分发恶意模板。在导出时，你可以指定用于排版Markdown文档的模板。模板可以是HTML文件、LaTeX文件，甚至是Word文档，所有这些文件都可以被注入恶意代码。

很可能你有时想要下载一个模板用来自定义导出。但是，由于可以在模板中插入恶意代码，攻击者可能会通过这种方式轻松侵入你计算机。

由于模板不是用Markdown编写的，因此当你从互联网下载模板时，我们建议要谨慎。Markdown文档被查看时可以做到安全显示，而模板在这方面要难得多。

如果你真的想要从互联网下载模板，请确保有值得信任的技术人员在你使用之前验证文档是否安全！

!!! 注意

    经验法则：即使是同事向你发送模板，请务必再次检查，因为你的同事可能意外下载了恶意模板并忽略了其中的恶意代码。

## 导入和导出过程中的代码执行

尽管你可以通过禁用所有渲染器来防止在阅读和编写Markdown文档时执行代码，但在导入和导出过程中无法禁止代码执行。为了正确地导入或导出你的文件，Zettlr必须允许代码执行。

例如，如果你的文档中包含有公式，导出为HTML将执行代码以正确地呈现这些公式。同样地，某些模板可能需要来自互联网的代码或资源才能正常运作。

即使你没有下载任何额外的模板，导入和导出仍可能构成安全风险。具体而言，一些随Zettlr同时下载的标准模板包含在线资源。虽然这些是安全的资源，但有时恶意行为者可能会侵入这些在线资源并注入有害代码。

这意味着即使你导出自己创建的没有特殊模板的Markdown文档，仍存在一定的安全风险。

导入和导出用到了Pandoc来执行，Pandoc本身提供了一套安全建议，我们建议你参阅、理解并遵循它们以确保你和你计算机的安全。阅读[Pandoc安全注意事项](https://pandoc.org/MANUAL#a-note-on-security))。

## 自定义导出命令

Zettlr允许你在设置文件中指定用于导出的任意命令。当你使用安装有Pandoc的预制Docker容器，或者当你需要将文件上传到某个地方时，这会非常方便。然而，你运行的任何命令应当是值得信任的。绝不要在设置中添加或运行你不完全信任的自定义命令。

!!! 注意

    经验法则：始终将所有导出和导入过程视为潜在不安全的。
